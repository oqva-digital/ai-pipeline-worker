services:
  worker:
    build: .
    restart: unless-stopped
    environment:
      - REDIS_URL=${REDIS_URL}
      - GITHUB_TOKEN=${GITHUB_TOKEN}
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - CLAUDE_CODE_REFRESH_TOKEN=${CLAUDE_CODE_REFRESH_TOKEN}
      - CLAUDE_CODE_EXPIRES_AT=${CLAUDE_CODE_EXPIRES_AT}
      - CI=true
      - TERM=dumb
    volumes:
      - ~/.ssh:/tmp/.ssh-mount:ro
      # Optional: mount credentials from project dir (created by install-deps.sh from .env)
      - ./.claude/.credentials.json:/tmp/.claude-credentials.json:ro
